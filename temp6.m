% Problem 18

m = [1 0 0; 0 1 0; 0 0 2];
c = [1 0 -1; 0 1 -1; -1 -1 -2];
k = [2 -1 -1; -1 2 -1; -1 -1 3];

F = [0; 0; 100];

[u, w] = eig(k, m);

u1 = u(:, [1]);
u2 = u(:, [2]);
u3 = u(:, [3]);

w = sqrt(w);

M = u.' * m * u;
K = u.' * k * u;
Q = u.' * F;

A = [0; 0; 0];

for i = [1 3]
	A(i, 1) = Q(i, 1) / (K(i, i) - 4 * M(i, i));
end

x = u * A;